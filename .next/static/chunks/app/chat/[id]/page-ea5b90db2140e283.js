(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[786],{7906:function(e,t,n){Promise.resolve().then(n.bind(n,5601))},5601:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(7334),a=n(7009),s=n(9775),c=n(2319),i=n(4141);function o(e){let{role:t,content:n}=e,a="assistant"===t;return(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-full ".concat(a?"bg-blue-500":"bg-gray-300")}),(0,r.jsxs)("div",{className:"max-w-3xl prose prose-slate dark:prose-invert",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:a?"DeepSeek":"你"}),(0,r.jsx)(s.UG,{remarkPlugins:[c.Z],rehypePlugins:[i.Z],children:n})]})]})}var l=n(5832),u=n(3780);function d(e){let{params:t}=e,[n,s]=(0,a.useState)([]),[c,i]=(0,a.useState)(""),d=(0,a.useRef)(null);async function f(){if(!c.trim())return;i(""),s(e=>[...e,{id:Math.random().toString(),role:"user",content:c}]);let e=await fetch("/api/chat/".concat(t.id,"/message"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:c})});if(!e.ok||!e.body)return;let n=e.body.getReader(),r=new TextDecoder,a="",o="temp-".concat(Date.now());for(s(e=>[...e,{id:o,role:"assistant",content:""}]);;){let{value:e,done:t}=await n.read();if(t)break;a+=r.decode(e,{stream:!0}),s(e=>e.map(e=>e.id===o?{...e,content:a}:e))}}return(0,a.useEffect)(()=>{(async()=>{let e=await fetch("/api/chat/".concat(t.id));s((await e.json()).messages||[])})()},[t.id]),(0,a.useEffect)(()=>{var e;null===(e=d.current)||void 0===e||e.scrollTo({top:d.current.scrollHeight})},[n]),(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsx)("div",{ref:d,className:"flex-1 overflow-y-auto px-6 py-6 space-y-6",children:0===n.length?(0,r.jsx)("div",{className:"text-center text-gray-500",children:"开始你的第一条对话吧~"}):n.map(e=>(0,r.jsx)(o,{role:e.role,content:e.content},e.id))}),(0,r.jsx)("div",{className:"border-t border-gray-100 p-4",children:(0,r.jsxs)("div",{className:"mx-auto max-w-3xl flex items-end gap-2",children:[(0,r.jsx)(l.g,{value:c,onChange:e=>i(e.target.value),rows:3,placeholder:"给 DeepSeek 发送消息",className:"resize-none"}),(0,r.jsx)(u.z,{onClick:f,children:"发送"})]})})]})}},3780:function(e,t,n){"use strict";n.d(t,{z:function(){return a}});var r=n(7334);let a=(0,n(7009).forwardRef)(function(e,t){let{className:n="",variant:a="primary",...s}=e;return(0,r.jsx)("button",{ref:t,...s,className:"".concat("primary"===a?"btn-primary":"px-3 py-2 rounded-md hover:bg-gray-100"," ").concat(n)})})},5832:function(e,t,n){"use strict";n.d(t,{I:function(){return s},g:function(){return c}});var r=n(7334),a=n(7009);let s=(0,a.forwardRef)(function(e,t){let{className:n="",...a}=e;return(0,r.jsx)("input",{ref:t,...a,className:"input ".concat(n)})}),c=(0,a.forwardRef)(function(e,t){let{className:n="",...a}=e;return(0,r.jsx)("textarea",{ref:t,...a,className:"input ".concat(n)})})}},function(e){e.O(0,[19,856,759,744],function(){return e(e.s=7906)}),_N_E=e.O()}]);